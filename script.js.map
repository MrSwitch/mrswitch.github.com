{
  "version": 3,
  "sources": ["node_modules/tricks/dom/create.js", "src/script.js"],
  "sourcesContent": ["// Create and Append new Dom elements\n// @param node string\n// @param attr object literal\nexport default (node, attr = {}, children = [], append = null) => {\n\n\tconst n = typeof(node) === 'string' ? document.createElement(node) : node;\n\n\t// Attributes\n\tfor (const x in attr) {\n\n\t\tif (Object.prototype.hasOwnProperty.call(attr, x)) {\n\n\t\t\tif (x === 'text') {\n\t\t\t\tn.appendChild(document.createTextNode(attr[x]));\n\t\t\t}\n\t\t\telse if (x === 'html') {\n\t\t\t\tif (typeof(attr[x]) === 'string') {\n\t\t\t\t\tn.innerHTML = attr[x];\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tn.appendChild(attr[x]);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (typeof(attr[x]) === 'object') {\n\t\t\t\tfor (const y in attr[x]) {\n\t\t\t\t\tif (Object.prototype.hasOwnProperty.call(attr[x], y)) {\n\t\t\t\t\t\tn[x][y] = attr[x][y];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (typeof(attr[x]) === 'function') {\n\t\t\t\tn.addEventListener(x, attr[x]);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tn.setAttribute(x, attr[x]);\n\t\t\t}\n\t\t}\n\t}\n\n\t// Children\n\tchildren.forEach(child => {\n\t\tif (typeof(child) === 'string') {\n\t\t\tchild = document.createTextNode(child);\n\t\t}\n\n\t\tif (child) {\n\t\t\tn.appendChild(child);\n\t\t}\n\t});\n\n\t// Append\n\tif (append) {\n\t\tappend.appendChild(n);\n\t}\n\n\treturn n;\n};\n", "// Script\n// This script controls the background page\nimport el from 'tricks/dom/create.js';\n\n// List of backgrounds\nconst backgroundList = ['colorFlood', 'mineField', 'tetris', 'tiledOfLife'];\n\n// Preload the backgrounds\nbackgroundList.map(script => el(\"link\", {\n\thref: `/background/dist/${script}.js`,\n\trel: \"preload\",\n\tas: \"script\"\n}, [], document.head));\n\n// Pick a random background\nlet backgroundIndex = Math.floor(Math.random() * backgroundList.length);\n\nlet iframe;\n\n/**\n * Load the background game\n */\nfunction loadBackground(index) {\n\tconst backgroundSelected = backgroundList.at(backgroundIndex%backgroundList.length);\n\tconst srcdoc = `\n<body>\n<script src=\"/background/dist/${backgroundSelected}.js\"></script>\n<script>\n// Install background\nself.background = self.background || [];\n</script>\n`;\n\tif(iframe) {\n\t\tiframe.srcdoc = srcdoc;\n\t\treturn iframe;\n\t}\n\t\n\treturn el('iframe', {\n\t\tid: 'background',\n\t\tsrcdoc\n\t}, [], document.body);\n}\n\niframe = loadBackground(backgroundIndex);\n\nlet bg;\n\nconst iframeContextWindow = iframe.contentWindow;\n\niframe.addEventListener('load', () => {\n\n\t// Push a function to call\n\tiframeContextWindow.background.push(BG => {\n\n\t\t// First time?\n\t\t// Create the controls\n\t\tif (!bg) {\n\t\t\tel('div', {\n\t\t\t\tclass: 'controls'\n\t\t\t}, [\n\t\t\t\tel('a', {\n\t\t\t\t\tid: 'prev_btn',\n\t\t\t\t\ttext: '\u25C0',\n\t\t\t\t\tclick: (e) => {\n\t\t\t\t\t\tloadBackground(--backgroundIndex);\n\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t}\n\t\t\t\t}),\n\t\t\t\tel('a', {\n\t\t\t\t\ttext: 'Play',\n\t\t\t\t\tid: 'play_btn',\n\t\t\t\t\thref: '#background',\n\t\t\t\t\tclick: (e) => {\n\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t}\n\t\t\t\t}),\n\t\t\t\tel('a', {\n\t\t\t\t\tid: 'next_btn',\n\t\t\t\t\ttext: '\u25B6',\n\t\t\t\t\tclick: (e) => {\n\t\t\t\t\t\tloadBackground(++backgroundIndex);\n\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t], document.body);\n\n\t\t\t// Create a controller to listen to toggling between states\n\t\t\twindow.addEventListener('hashchange', hashchange);\n\t\t}\n\t\t\n\n\t\t// Passing in null for target inserts it into the body background\n\t\tbg = BG.init(null);\n\n\t\t// Set default state\n\t\tbg.setup?.({\n\t\t\tcontrols: false,\n\t\t});\n\n\t\thashchange();\n\n\t});\n});\n\n\n\n// Listen to the background trigger to show/hide the background\nfunction hashchange() {\n\t// Has the backdrop come into the focus?\n\tconst controls = window.location.hash === '#background';\n\n\t// Add/Remove class from window\n\twindow.document.documentElement.classList[controls ? 'add' : 'remove'](\n\t\t'background'\n\t);\n\n\tbg.config?.({controls});\n}\n\n// Fix ios scrolling issue\ndocument.addEventListener(\n\t'touchmove',\n\tevent => {\n\t\tevent.preventDefault();\n\t},\n\tfalse\n);\n"],
  "mappings": "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",
  "names": ["create_default", "node", "attr", "children", "append", "n", "x", "y", "child", "backgroundList", "script", "create_default", "backgroundIndex", "iframe", "loadBackground", "index", "srcdoc", "bg", "iframeContextWindow", "BG", "e", "hashchange", "controls", "event"]
}
